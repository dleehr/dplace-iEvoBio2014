<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Dan Leehr - iEvoBio 2014</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/moon.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		
		<!-- jVectorMap CSS-->
		<link rel="stylesheet" href="lib/css/jquery-jvectormap-1.1.1.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
    <section class="" data-id="47931731a25a16a9cead63a648ed8621">
        <h1>D-PLACE</h1>
        <h2>
        </h2>
        <h2>
        Integrating Geospatial functionality<br>
        into a database of human<br>
        cultural diversity</h2>
        <br>

<p>Dan Leehr<span>
        <br>
    </span>
    <span>National Evolutionary Synthesis Center<br>
    </span>
    <span>
        <br>
    </span>
</p>
<p>
<span>iEvoBio 2014</span>
</p>




</section>
<section class="" data-id="6895133e28860e4a026501b1d824cf04">
    <h2>
<span>Backstory&nbsp;</span>
<br>
</h2>
<div>
    <br>
    <img src="https://s3.amazonaws.com/media-p.slid.es/uploads/dleehr/images/458828/NESCent_logo_white.png" style="width: 378.3588317107093px; height: 353.7081805537995px; max-height: none; max-width: none;">
    <img src="https://s3.amazonaws.com/media-p.slid.es/uploads/dleehr/images/458831/5492899300_6198717646_z.jpg" style="width: 485.7459434399629px; height: 355.67653204490176px; max-height: none; max-width: none;">
    <blockquote>Photo via flickr/dnlee5 </blockquote>
</div>
<br>
</section>
<section class="stack" data-id="20b661dda46248fb8530ecfe25d83b2a">
    <section class="" data-id="147ecbed6f32b96ce583339cb0d2a47a">
        <h2>
    <span>Technology Backend</span>
</h2>
<div>
    <span>
        <br>
    </span>
</div>
<div>
    <ul>
        <li class="visible" data-fragment-index="0">
<font style="font-size: 42px;">PostgreSQL</font>
</li>
        <li class="visible" data-fragment-index="1">
<font style="font-size: 42px;">Django</font>
</li>
        <li class="visible" data-fragment-index="2">
<font style="font-size: 42px;">PostGIS + GeoDjango</font>
</li>
        <li class="visible" data-fragment-index="3">
<font style="font-size: 42px;">Django REST Framework</font>
</li>
    </ul>
    </div>
<div style="text-align: center;">
    <br>
</div>
<p class="fragment" data-fragment-index="0">
<span>Python + PostgreSQL</span>
<br>
</p>
<p class="fragment" data-fragment-index="1">Fast, sensible models from shapefiles<br>
<span>Easy GIS queries</span>
</p>

<pre class="fragment" data-fragment-index="2">
        <code>Society.objects.where(region__intersects=someregion)</code>
    </pre>

<p class="fragment" data-fragment-index="3">
    <span>JSON for all</span>
    <br>


</p>
</section>
<section class="" data-id="23bef7fbfc3352e4179c8cc75e6b4732">
<h2>JSON API</h2>
<div>
    <br>
</div>
<div>
<pre><code>$ curl -s http://localhost:8000/api/v1/geographic_regions/?region_nam=Pacific
{
&nbsp; &nbsp; "count": 4,
&nbsp; &nbsp; "next": null,
&nbsp; &nbsp; "previous": null,
&nbsp; &nbsp; "results": [
&nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "continent": "PACIFIC",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "count": 59.0,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "id": 31,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "level_2_re": 60.0,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "region_nam": "Southwestern Pacific",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "tdwg_code": 60
&nbsp; &nbsp; &nbsp; &nbsp; },
&nbsp; &nbsp; &nbsp; &nbsp; ...
&nbsp; &nbsp; ]
} 

</code></pre>
<p>
With filtering!
</p>
</div>
<div>
</div>


</section>
<section class="" data-id="71217f1d97e2e11339ad578d06b33d1f">
    <h2>Models from Shapefiles</h2>
<div>
<pre><code>manage.py ogrinspect level2.shp GeographicRegion --srid=4326 
           --mapping --multi 
</code></pre>
</div>Model:<br>
<div class="fragment" data-fragment-index="0">
<pre><code>class GeographicRegion(models.Model):
&nbsp; &nbsp; level_2_re = models.FloatField()
&nbsp; &nbsp; count = models.FloatField()
&nbsp; &nbsp; region_nam = models.CharField(max_length=254)
&nbsp; &nbsp; continent = models.CharField(max_length=254)
&nbsp; &nbsp; tdwg_code = models.IntegerField()
&nbsp; &nbsp; geom = models.MultiPolygonField(srid=4326)
&nbsp; &nbsp; objects = models.GeoManager()<br></code></pre>
</div>LayerMapping:<div class="fragment" data-fragment-index="1">
<div>
<pre><code>geographicregion_mapping = {
&nbsp; &nbsp; 'level_2_re' : 'LEVEL_2_RE',
&nbsp; &nbsp; 'count' : 'COUNT',
&nbsp; &nbsp; 'region_nam' : 'REGION_NAM',
&nbsp; &nbsp; 'continent' : 'CONTINENT',
&nbsp; &nbsp; 'tdwg_code' : 'TDWG_CODE',
&nbsp; &nbsp; 'geom' : 'MULTIPOLYGON',
}
</code></pre>
</div>
</div>
</section>
</section>
<section class="stack" data-id="bc19fca6d232f339ba6791035f4f7079">
    <section class="" data-id="d02b75faa49d47625945db13ab9cd4fd">
        <h2>
    <span>Technology Frontend</span>
</h2>
<div>
    <span>
        <br>
    </span>
</div>
<div>
    <ul>
        <li>
        <font style="font-size: 42px;">AngularJS</font>
    </li>
        <li>
    <font style="font-size: 42px;">jVectorMap</font>
</li>
<li>
<font style="font-size: 42px;">Bootstrap</font>
</li>
        </ul>
</div>
<div style="text-align: center;">
    <br>
</div>
<p class="fragment" data-fragment-index="0">AngularJS = MVW, Heroic, Awesome!</p>
<pre class="fragment" data-fragment-index="1">
<code>FindSocieties.find({ geographic_regions: geographicRegions }, ...) </code>
</pre>
<p data-fragment-index="2" class="fragment">
<span>Bind Map UI to model</span>
<br>
</p>
<pre class="fragment" data-fragment-index="3">
<code>&lt;dplace-map selected-regions="model.selectedRegions"&gt;</code>
</pre>
<br>
</section>
<section class="" data-id="488fc53e14d2777e261ae238cdba54e1">
<h2>jVectorMap Converter</h2>
<div>
<pre><code>converter.py --width 1000 --country_code_index 4 --country_name_index 2
    level2.shp tdwg-level2-map.js </code></pre>
</div>
<div>

</div>
<div>Turns this shapefile:
</div>
<div class="fragment" data-fragment-index="0">
<pre><code>Geometry: Polygon
Feature Count: 52
Extent: (-180.000000, -90.000000) - (180.000000, 83.623596)
LEVEL_2_RE: Real (16.6)
COUNT: Real (11.0)
REGION_NAM: String (254.0)
CONTINENT: String (254.0)
TDWG_CODE: Integer (4.0)
OGRFeature(level2):0
&nbsp; LEVEL_2_RE (Real) = 10.000000
&nbsp; COUNT (Real) = 89
&nbsp; REGION_NAM (String) = Northern Europe
&nbsp; CONTINENT (String) = EUROPE
&nbsp; TDWG_CODE (Integer) = 10
&nbsp; MULTIPOLYGON (((12.183610916137695 54.880271911621094,12.163610458374023 54.883049011230469,12.150833129882812 54.8861083984375,12.115833282470703 54.904159545898438,12.132221221923828 54.951385498046875,12.135831832885742&nbsp; </code></pre>
</div>
<br>
</section>

<script src="lib/js/jquery-1.11.1.min.js"></script>
<script src="lib/js/jquery-jvectormap-1.2.2.min.js"></script>
<script src="lib/js/tdwg-level2-map.js"></script>

<section class="" data-id="8ce453e7b2af061635c089b439b831c9">
    <h2>Javascript Map</h2>
<div>Into this:</div>
<div data-fragment-index="0" class="fragment" style="width:100%; height:500px;" id="mapdiv"></div>
<script>
      $('#mapdiv').vectorMap({
        map: 'tdwg-level2',
        backgroundColor: 'clear',
        regionStyle: {
          initial: {
            fill: '#428bca',
            "fill-opacity": 1,
            stroke: '#357ebd',
            "stroke-width": 0,
            "stroke-opacity": 1
          },
          hover: {
            "fill-opacity": 0.8
          },
          selected: {
            fill: '#113'
          },
          selectedHover: {
          }
        },
        regionsSelectable: true
        });
</script>
</section>
</section>
<section class="" data-id="a0db34ff170e8411b15b0341453323c6">
    <h2>Dependency Implications</h2>
<div>
    <br>
</div>
<div>
    <ol>
        <li class="fragment" data-fragment-index="0">Automated Testing -&nbsp;<a href="https://travis-ci.org/NESCent/dplace">Travis</a>
<img src="https://travis-ci.org/NESCent/dplace.svg?branch=master" li="">
        </li>
<li data-fragment-index="1" class="fragment">Up and running &nbsp;with one command&nbsp;<a href="https://github.com/dleehr/dplace-vagrant">Vagrant</a>
</li>
<li data-fragment-index="2" class="fragment">JSON API For <a href="http://p.printingchoice.com/8-examples-of-horrific-fine-print/">free</a>*&nbsp;</li>
</ol>
<div style="text-align: left;">
<br>
</div>
</div>
<div style="text-align: left;">
<br>
</div>
<p style="text-align: left; " class="fragment" data-fragment-index="3">
<font color="#d9d9d9">* <font style="font-size: 24px;">API is not actually free. Processed on servers that also process peanuts. For best results, remove cap first. Do not eat iPod shuffle. Do not use while sleeping. Do not direct steam at &nbsp;people or animals or iron clothes while they are being worn.&nbsp;</font>
</font>
</p>

</section>
    <section class="" data-id="e804b90bb24ee79f02eda824315d0115">
        <h2>Summary</h2>
        <div>Backend is rich and opinionated</div>
        <div>Frontend is modular and agnostic</div>
        <div>
            <br>
        </div>
        <div>Fast development, still have control</div>
        <div>
            <br>
        </div>
        <div>
            <div>
                <a href="https://github.com/NESCent/dplace">github.com/NESCent/dplace</a>
            </div>
        </div>
        <div>
            <br>
        </div>
        <div class="fragment" data-fragment-index="0">Questions?</div>
    </section>
</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

    Reveal.addEventListener( 'fragmentshown', function( event ) {
      console.log(event.fragment);
        if(event.fragment.id == 'mapdiv') {
          $('#mapdiv').vectorMap('get','mapObject').setSize();
        }
    } );        

		</script>

	</body>
</html>
